<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N4 語彙</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-50 to-emerald-100 min-h-screen p-4">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-xl shadow-xl p-6 mb-4">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-2xl font-bold text-gray-800">JLPT N4 語彙</h1>
                <button onclick="reset()" class="p-2 hover:bg-gray-100 rounded-lg">
                    <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                </button>
            </div>

            <div class="flex gap-2 mb-4">
                <button id="learnBtn" onclick="setMode('learn')" class="flex-1 py-2 px-4 rounded-lg font-medium bg-emerald-600 text-white">
                    学習モード
                </button>
                <button id="quizBtn" onclick="setMode('quiz')" class="flex-1 py-2 px-4 rounded-lg font-medium bg-gray-100 text-gray-700">
                    クイズモード
                </button>
            </div>

            <div class="mb-4">
                <div class="flex justify-between text-sm text-gray-600 mb-2">
                    <span id="progress"></span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progressBar" class="bg-emerald-600 h-2 rounded-full transition-all"></div>
                </div>
            </div>

            <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-8 mb-4 text-center">
                <div id="vocabularyDisplay" class="text-6xl font-bold text-emerald-900 mb-4"></div>
                <div id="answerDisplay"></div>
            </div>

            <div id="controls"></div>
        </div>
    </div>

    <script>
        const vocab = [
            { word: '生活', reading: 'せいかつ', meaning: 'まいにちのくらし', example: '日本で生活しています。' },
            { word: '仕事', reading: 'しごと', meaning: 'かいしゃなどですること', example: '仕事がいそがしいです。' },
            { word: '会社', reading: 'かいしゃ', meaning: 'しごとをするところ', example: '会社ではたらいています。' },
            { word: '時間', reading: 'じかん', meaning: 'ときのながさ', example: '時間がありません。' },
            { word: '旅行', reading: 'りょこう', meaning: 'とおくへいくこと', example: 'きょうとへ旅行に行きます。' },
            { word: '電車', reading: 'でんしゃ', meaning: 'せんろのうえをはしるくるま', example: '電車で行きます。' },
            { word: '駅', reading: 'えき', meaning: 'でんしゃにのるところ', example: '駅で会いましょう。' },
            { word: '病院', reading: 'びょういん', meaning: 'びょうきのひとがいくところ', example: '病院へ行きます。' },
            { word: '音', reading: 'おと', meaning: 'きこえるもの', example: 'となりのへやから音がきこえます。' },
            { word: '天気', reading: 'てんき', meaning: 'そらのようす', example: '今日は天気がいいです。' },
            { word: '予約', reading: 'よやく', meaning: 'まえにきめておくこと', example: 'ホテルを予約しました。' },
            { word: '海', reading: 'うみ', meaning: 'おおきなみず', example: '海でおよぎました。' },
            { word: '大学', reading: 'だいがく', meaning: 'せんもんをべんきょうするところ', example: '大学で勉強しています。' },
            { word: '広い', reading: 'ひろい', meaning: 'スペースがおおきい', example: 'このアパートは広いです。' },
            { word: '使う', reading: 'つかう', meaning: 'どうぐなどをりようする', example: 'スマホを使います。' },
            { word: '作る', reading: 'つくる', meaning: 'あたらしくつくりだす', example: '料理を作ります。' },
            { word: '始める', reading: 'はじめる', meaning: 'スタートする', example: '勉強を始めます。' },
            { word: '終わる', reading: 'おわる', meaning: 'していたことがもうない', example: '仕事が終わりました。' },
            { word: '続ける', reading: 'つづける', meaning: 'やめないでやる', example: '日本語の勉強を続けます。' },
            { word: '交通', reading: 'こうつう', meaning: 'のりもののうごき', example: 'このまちは交通がふべんです。' },
            { word: '暑い', reading: 'あつい', meaning: 'てんきがたかい', example: 'このへやは暑いですね。' },
            { word: '待つ', reading: 'まつ', meaning: 'とまっている', example: 'ちょっと待ってください。' },
            { word: '入院', reading: 'にゅういん', meaning: 'びょういんにはいる', example: 'らいげつ入院することになりました。' },
            { word: '遅れる', reading: 'おくれる', meaning: 'よていのじかんよりあとになる', example: '学校に遅れました。' },
            { word: '変わる', reading: 'かわる', meaning: 'ちがうじょうたいになる', example: '天気が変わりました。' },
            { word: '忙しい', reading: 'いそがしい', meaning: 'することがおおい', example: '今日は忙しいです。' },
            { word: '大切', reading: 'たいせつ', meaning: 'とてもじゅうよう', example: '家族は大切です。' },
            { word: '便利', reading: 'べんり', meaning: 'つかいやすい', example: 'この町は便利です。' },
            { word: '有名', reading: 'ゆうめい', meaning: 'よくしられている', example: 'ふじさんはとても有名です。' },
            { word: '簡単', reading: 'かんたん', meaning: 'むずかしくない', example: 'このもんだいは簡単です。' },
            { word: '早い', reading: 'はやい', meaning: 'じかんがみじかい', example: 'もう少し早いほうがいいです。' },
            { word: '一度', reading: 'いちど', meaning: 'ひとつのかい', example: 'おおさかに一度いったことがあります。' },
            { word: '安全', reading: 'あんぜん', meaning: 'あぶなくない', example: 'この道は安全です。' },
            { word: '空港', reading: 'くうこう', meaning: 'ひこうきのとまるところ', example: '今、空港にいます。' },
            { word: '寒い', reading: 'さむい', meaning: 'てんきがひくい', example: '今日は寒いですね。' }
        ];

        let idx = 0;
        let mode = 'learn';
        let score = { correct: 0, total: 0 };
        let showAns = false;
        let selAns = null;
        let opts = [];

        function genOpts() {
            const correct = vocab[idx].reading;
            const currWord = vocab[idx].word;
            const options = [correct];
            const allReads = vocab.filter(v => v.word !== currWord).map(v => v.reading);
            while (options.length < 4) {
                const r = allReads[Math.floor(Math.random() * allReads.length)];
                if (!options.includes(r)) options.push(r);
            }
            return options.sort(() => Math.random() - 0.5);
        }

        function updateDisp() {
            const curr = vocab[idx];
            document.getElementById('vocabularyDisplay').textContent = curr.word;
            document.getElementById('progress').textContent = (idx + 1) + ' / ' + vocab.length;
            document.getElementById('progressBar').style.width = ((idx + 1) / vocab.length * 100) + '%';

            if (mode === 'learn') {
                document.getElementById('answerDisplay').innerHTML = 
                    '<div class="text-2xl text-emerald-700 font-medium mb-2">' + curr.reading + '</div>' +
                    '<div class="text-lg text-gray-700 mt-3 px-4 py-3 bg-white rounded-lg">れい: ' + curr.example + '</div>';
            } else if (showAns) {
                document.getElementById('answerDisplay').innerHTML = 
                    '<div class="text-2xl text-emerald-700 font-medium mb-2">' + curr.reading + '</div>' +
                    '<div class="text-lg text-gray-700 mt-3 px-4 py-3 bg-white rounded-lg">れい: ' + curr.example + '</div>';
            } else {
                document.getElementById('answerDisplay').innerHTML = '';
            }
            updateCtrls();
        }

        function updateCtrls() {
            const ctrls = document.getElementById('controls');
            if (mode === 'learn') {
                ctrls.innerHTML = 
                    '<div class="flex gap-2">' +
                    '<button onclick="prevWord()" ' + (idx === 0 ? 'disabled' : '') + ' class="flex-1 py-3 px-4 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 disabled:opacity-50">前へ</button>' +
                    '<button onclick="nextWord()" ' + (idx === vocab.length - 1 ? 'disabled' : '') + ' class="flex-1 py-3 px-4 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700 disabled:opacity-50">次へ</button>' +
                    '</div>';
            } else {
                if (!showAns) {
                    let html = '<div class="grid grid-cols-2 gap-3">';
                    for (let i = 0; i < opts.length; i++) {
                        html += '<button onclick="handleAns(\'' + opts[i] + '\')" class="py-3 px-4 text-lg bg-emerald-100 text-emerald-900 rounded-lg font-medium hover:bg-emerald-200">' + opts[i] + '</button>';
                    }
                    html += '</div>';
                    ctrls.innerHTML = html;
                } else if (selAns === vocab[idx].reading) {
                    ctrls.innerHTML = '<div class="text-center"><div class="text-xl font-bold text-green-600">正解!</div></div>';
                } else {
                    ctrls.innerHTML = 
                        '<div class="text-center mb-3">' +
                        '<div class="text-xl font-bold text-red-600 mb-2">不正解</div>' +
                        '<div class="text-lg text-gray-700">正解: <span class="text-emerald-700 font-semibold">' + vocab[idx].reading + '</span></div>' +
                        '</div>' +
                        '<button onclick="retry()" class="w-full py-3 px-4 bg-emerald-600 text-white rounded-lg font-medium hover:bg-emerald-700">もう一度挑戦</button>';
                }
            }
        }

        function setMode(m) {
            mode = m;
            showAns = false;
            selAns = null;
            idx = 0;
            if (mode === 'quiz') {
                score = { correct: 0, total: 0 };
                opts = genOpts();
            }
            document.getElementById('learnBtn').className = mode === 'learn' ? 'flex-1 py-2 px-4 rounded-lg font-medium bg-emerald-600 text-white' : 'flex-1 py-2 px-4 rounded-lg font-medium bg-gray-100 text-gray-700';
            document.getElementById('quizBtn').className = mode === 'quiz' ? 'flex-1 py-2 px-4 rounded-lg font-medium bg-emerald-600 text-white' : 'flex-1 py-2 px-4 rounded-lg font-medium bg-gray-100 text-gray-700';
            updateDisp();
        }

        function nextWord() {
            if (idx < vocab.length - 1) {
                idx++;
                showAns = false;
                updateDisp();
            }
        }

        function prevWord() {
            if (idx > 0) {
                idx--;
                showAns = false;
                updateDisp();
            }
        }

        function handleAns(ans) {
            selAns = ans;
            const correct = ans === vocab[idx].reading;
            showAns = true;
            updateDisp();
            if (correct) {
                score.correct++;
                score.total++;
                setTimeout(function() {
                    if (idx < vocab.length - 1) {
                        idx++;
                        showAns = false;
                        selAns = null;
                        opts = genOpts();
                        updateDisp();
                    }
                }, 800);
            } else {
                score.total++;
            }
        }

        function retry() {
            showAns = false;
            selAns = null;
            opts = genOpts();
            updateDisp();
        }

        function reset() {
            idx = 0;
            showAns = false;
            score = { correct: 0, total: 0 };
            selAns = null;
            if (mode === 'quiz') opts = genOpts();
            updateDisp();
        }

        updateDisp();
    </script>
</body>
</html>